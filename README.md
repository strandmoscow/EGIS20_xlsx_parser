Спасибо за ссылку на репозиторий: [https://github.com/strandmoscow/EGIS20_xlsx_parser](https://github.com/strandmoscow/EGIS20_xlsx_parser).

Ниже приведён пример базовой документации (README.md) для вашего проекта. Она включает описание назначения, структуры, основных скриптов и примеры запуска.

---

# EGIS20_xlsx_parser

**EGIS20_xlsx_parser** — это система для парсинга Excel-отчетов по требованиям ЕГИС, наполнения базы данных и формирования новых отчетов, а также интеграции с Confluence.

## Оглавление

- [Назначение](#назначение)
- [Структура проекта](#структура-проекта)
- [Установка](#установка)
- [Использование](#использование)
- [Описание основных модулей](#описание-основных-модулей)
- [Интеграция с Confluence](#интеграция-с-confluence)
- [Автоматизация через Telegram-бота](#автоматизация-через-telegram-бота)
- [Требования](#требования)
- [Контакты](#контакты)

---

## Назначение

Система предназначена для автоматизации работы с требованиями ЕГИС:
- Парсинг и обработка Excel-файлов с требованиями.
- Загрузка и обновление информации в базе данных.
- Генерация новых отчетов для подсистем ЕГИС 1.0 и 2.0.
- Загрузка отчетов в Confluence.
- Управление процессом через Telegram-бота.

---

## Структура проекта

```
EGIS20_xlsx_parser/
│
├── confluence_module.py      # Модуль интеграции с Confluence
├── gen_xlsx_egis1.py         # Генерация отчетов для подсистем ЕГИС 1.0
├── gen_xlsx_egis2.py         # Генерация отчетов для подсистем ЕГИС 2.0
├── main.py                   # Основная точка входа (запуск сценариев)
├── parse_excel_to_db.py      # Парсинг Excel-файлов и загрузка в БД
├── tg_bot.py                 # Telegram-бот для управления процессом
├── utils.py                  # Вспомогательные функции (работа с БД, конфигами и т.д.)
├── requirements.txt          # Список зависимостей
└── .idea/                    # Конфигурация среды разработки (PyCharm)
```

---

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/strandmoscow/EGIS20_xlsx_parser.git
   cd EGIS20_xlsx_parser
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Настройте параметры подключения к базе данных и Confluence в конфигурационных файлах или переменных окружения (см. [пример](#пример-конфига)).

---

## Использование

### Парсинг Excel и наполнение базы

```bash
python parse_excel_to_db.py
```

### Генерация отчетов для подсистем ЕГИС 1.0

```bash
python gen_xlsx_egis1.py
```

### Генерация отчетов для подсистем ЕГИС 2.0

```bash
python gen_xlsx_egis2.py
```

### Загрузка отчетов в Confluence

```bash
python confluence_module.py
```

### Управление через Telegram-бота

```bash
python tg_bot.py
```

---

## Описание основных модулей

- **parse_excel_to_db.py**  
  Парсит Excel-файлы с требованиями, валидирует и загружает данные в базу данных.

- **gen_xlsx_egis1.py**  
  Формирует отчеты для подсистем ЕГИС 1.0 на основе данных из БД.

- **gen_xlsx_egis2.py**  
  Формирует отчеты для подсистем ЕГИС 2.0.

- **confluence_module.py**  
  Загружает сформированные отчеты на страницы Confluence через REST API.

- **tg_bot.py**  
  Позволяет запускать основные процессы через Telegram-бота, получать уведомления и отчеты.

- **utils.py**  
  Содержит вспомогательные функции для работы с БД, файлами, конфигами и т.д.

---

## Интеграция с Confluence

Для загрузки отчетов в Confluence используются REST API и токены Atlassian.  
Рекомендуется хранить креденшелы в отдельном файле (`confluence_creds.json`):

```json
{
  "url": "https://your-domain.atlassian.net/wiki",
  "username": "your-email@example.com",
  "api_token": "your-api-token"
}
```

---

## Автоматизация через Telegram-бота

Модуль `tg_bot.py` позволяет:
- Запускать парсинг и генерацию отчетов по команде.
- Получать статус выполнения задач.
- Получать уведомления о завершении процессов.

---

## Требования

- Python 3.8+
- PostgreSQL (для хранения данных)
- Необходимые библиотеки из `requirements.txt` (pandas, openpyxl, requests и др.)

---

## Контакты

Автор: strandmoscow  
GitHub: [https://github.com/strandmoscow/EGIS20_xlsx_parser](https://github.com/strandmoscow/EGIS20_xlsx_parser)

---

**Если нужна более подробная документация по каждому модулю или функции, пришлите, пожалуйста, интересующие вас части кода или уточните задачи — я подготовлю расширенное описание и примеры использования.**

Citations:
[1] https://github.com/strandmoscow/EGIS20_xlsx_parser

---
Answer from Perplexity: pplx.ai/share
